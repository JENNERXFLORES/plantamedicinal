<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Administración - PlantaMedicinal</title>
    
    <!-- CSS Framework y Fuentes -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Estilos personalizados -->
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Chart.js para estadísticas -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Tailwind Config personalizado -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'verde-medicina': '#2d5a3d',
                        'verde-claro': '#4ade80',
                        'tierra': '#8b4513',
                        'dorado': '#fbbf24',
                    },
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                        'poppins': ['Poppins', 'sans-serif'],
                    }
                }
            }
        }
    </script>
</head>
<body class="font-inter bg-gray-100 min-h-screen">
    
    <!-- Header con navegación de admin -->
    <nav class="bg-white shadow-lg sticky top-0 z-50" id="adminNav">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo y título -->
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-verde-medicina to-green-600 rounded-full flex items-center justify-center">
                        <i class="fas fa-cogs text-white text-lg"></i>
                    </div>
                    <div>
                        <h1 class="font-poppins font-bold text-xl text-verde-medicina">Panel de Administración</h1>
                        <p class="text-xs text-gray-600 hidden sm:block">PlantaMedicinal</p>
                    </div>
                </div>

                <!-- Navegación admin -->
                <div class="hidden md:flex items-center space-x-6">
                    <a href="#dashboard" onclick="showAdminSection('dashboard')" class="admin-nav-link active">
                        <i class="fas fa-chart-line mr-2"></i>Dashboard
                    </a>
                    <a href="#moderacion" onclick="showAdminSection('moderacion')" class="admin-nav-link">
                        <i class="fas fa-gavel mr-2"></i>Moderación
                    </a>
                    <a href="#usuarios" onclick="showAdminSection('usuarios')" class="admin-nav-link">
                        <i class="fas fa-users mr-2"></i>Usuarios
                    </a>
                    <a href="#reportes" onclick="showAdminSection('reportes')" class="admin-nav-link">
                        <i class="fas fa-flag mr-2"></i>Reportes
                    </a>
                </div>

                <!-- Acciones admin -->
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <button id="notificationsBtn" class="relative p-2 text-gray-600 hover:text-verde-medicina">
                            <i class="fas fa-bell text-xl"></i>
                            <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">3</span>
                        </button>
                    </div>
                    <a href="index.html" class="px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                        <i class="fas fa-home mr-2"></i>Ir al Sitio
                    </a>
                    <button onclick="cerrarSesion()" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
                        <i class="fas fa-sign-out-alt mr-2"></i>Cerrar Sesión
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Contenido principal del panel admin -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Sección Dashboard -->
        <section id="dashboard-section" class="admin-section">
            <div class="mb-8">
                <h2 class="text-3xl font-bold text-gray-900 mb-2">Dashboard General</h2>
                <p class="text-gray-600">Resumen de la actividad de la plataforma</p>
            </div>

            <!-- Métricas principales -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-200">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-gray-600">Total Usuarios</p>
                            <p class="text-2xl font-bold text-gray-900" id="totalUsuarios">1,247</p>
                        </div>
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-users text-blue-600 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4 flex items-center text-sm">
                        <span class="text-green-600 font-medium">+12.5%</span>
                        <span class="text-gray-600 ml-1">vs mes anterior</span>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-200">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-gray-600">Plantas Catalogadas</p>
                            <p class="text-2xl font-bold text-gray-900" id="totalPlantas">156</p>
                        </div>
                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-leaf text-green-600 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4 flex items-center text-sm">
                        <span class="text-green-600 font-medium">+8</span>
                        <span class="text-gray-600 ml-1">este mes</span>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-200">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-gray-600">Recetas Aprobadas</p>
                            <p class="text-2xl font-bold text-gray-900" id="totalRecetas">324</p>
                        </div>
                        <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-mortar-pestle text-yellow-600 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4 flex items-center text-sm">
                        <span class="text-green-600 font-medium">+15</span>
                        <span class="text-gray-600 ml-1">esta semana</span>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-200">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-gray-600">Pendientes Revisión</p>
                            <p class="text-2xl font-bold text-orange-600" id="totalPendientes">23</p>
                        </div>
                        <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-clock text-orange-600 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4 flex items-center text-sm">
                        <span class="text-orange-600 font-medium">Requiere atención</span>
                    </div>
                </div>
            </div>

            <!-- Gráficos -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Usuarios Registrados (Últimos 6 meses)</h3>
                    <div style="height: 300px;">
                        <canvas id="usuariosChart"></canvas>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Recetas por Categoría</h3>
                    <div style="height: 300px;">
                        <canvas id="recetasChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Actividad reciente -->
            <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Actividad Reciente</h3>
                <div class="space-y-4" id="actividadReciente">
                    <!-- Se llena dinámicamente -->
                </div>
            </div>
        </section>

        <!-- Sección Moderación -->
        <section id="moderacion-section" class="admin-section hidden">
            <div class="mb-8">
                <h2 class="text-3xl font-bold text-gray-900 mb-2">Centro de Moderación</h2>
                <p class="text-gray-600">Revisa y aprueba contenido pendiente</p>
            </div>

            <!-- Filtros de moderación -->
            <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-200 mb-6">
                <div class="flex flex-col md:flex-row gap-4 items-center">
                    <select id="moderacionFilter" class="px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-verde-medicina">
                        <option value="todos">Todos los elementos</option>
                        <option value="recetas">Solo recetas</option>
                        <option value="comentarios">Solo comentarios</option>
                        <option value="reportes">Solo reportes</option>
                    </select>
                    
                    <select id="estadoModeraciopn" class="px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-verde-medicina">
                        <option value="pendiente">Pendientes</option>
                        <option value="aprobado">Aprobados</option>
                        <option value="rechazado">Rechazados</option>
                    </select>
                    
                    <div class="flex-1"></div>
                    
                    <div class="text-sm text-gray-600">
                        <span id="moderacionStats">23 elementos pendientes de revisión</span>
                    </div>
                </div>
            </div>

            <!-- Lista de elementos para moderar -->
            <div class="space-y-4" id="moderacionContainer">
                <!-- Se llena dinámicamente -->
            </div>
        </section>

        <!-- Sección Usuarios -->
        <section id="usuarios-section" class="admin-section hidden">
            <div class="mb-8">
                <h2 class="text-3xl font-bold text-gray-900 mb-2">Gestión de Usuarios</h2>
                <p class="text-gray-600">Administra usuarios y permisos</p>
            </div>

            <!-- Herramientas de usuarios -->
            <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-200 mb-6">
                <div class="flex flex-col md:flex-row gap-4 items-center">
                    <div class="relative flex-1">
                        <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        <input type="text" id="usuarioSearch" placeholder="Buscar usuarios por nombre, email..."
                               class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-verde-medicina">
                    </div>
                    
                    <select id="rolFilter" class="px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-verde-medicina">
                        <option value="">Todos los roles</option>
                        <option value="administrador">Administradores</option>
                        <option value="proveedor">Proveedores</option>
                        <option value="usuario">Usuarios</option>
                    </select>
                    
                    <select id="estadoUsuarioFilter" class="px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-verde-medicina">
                        <option value="">Todos los estados</option>
                        <option value="activo">Activos</option>
                        <option value="inactivo">Inactivos</option>
                        <option value="suspendido">Suspendidos</option>
                    </select>
                </div>
            </div>

            <!-- Tabla de usuarios -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Usuario</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rol</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Estado</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Registro</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actividad</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="usuariosTableBody" class="bg-white divide-y divide-gray-200">
                            <!-- Se llena dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Sección Reportes -->
        <section id="reportes-section" class="admin-section hidden">
            <div class="mb-8">
                <h2 class="text-3xl font-bold text-gray-900 mb-2">Reportes de Contenido</h2>
                <p class="text-gray-600">Gestiona reportes de contenido inapropiado</p>
            </div>

            <!-- Lista de reportes -->
            <div class="space-y-4" id="reportesContainer">
                <!-- Se llena dinámicamente -->
            </div>
        </section>

    </main>

    <!-- Modal de detalles de usuario -->
    <div id="userDetailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-2xl w-full max-h-screen overflow-y-auto">
            <div id="userDetailContent">
                <!-- Se llena dinámicamente -->
            </div>
        </div>
    </div>

    <!-- Modal de confirmación -->
    <div id="confirmModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl max-w-md w-full p-6">
            <div class="text-center">
                <i class="fas fa-exclamation-triangle text-yellow-500 text-4xl mb-4"></i>
                <h3 class="text-lg font-semibold text-gray-900 mb-2" id="confirmTitle">Confirmar Acción</h3>
                <p class="text-gray-600 mb-6" id="confirmMessage">¿Estás seguro de que quieres realizar esta acción?</p>
                <div class="flex justify-center space-x-4">
                    <button onclick="closeConfirmModal()" class="px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50">
                        Cancelar
                    </button>
                    <button id="confirmAction" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">
                        Confirmar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts JavaScript -->

    <script src="js/api-config.js"></script>
    <script src="js/auth-migrated.js"></script>
    <script src="js/migration-adapter.js"></script>
    
    <script src="js/main.js"></script>
    
    <script src="js/admin.js"></script>
</body>
</html>
